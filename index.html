<!DOCTYPE HTML>
<html>

  <head>
    <script src="js/jquery-1.11.0.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    
    <script>
    var numStars = 3;

    function redirect(string){
      window.location = string;
    }

    $(function(){
      $("#inventoryButton").click(function(){
        var divClass = $("#inventoryButton").attr("class");
	if(divClass == 'open'){
          $("#mainBody").animate({left:'0%'});
          $("#inventoryButton").attr('class','notOpen');
          document.getElementById("inventoryButton").innerHTML = 'Close Inventory';
        }
        else{
          $("#mainBody").animate({left:'-80%'});
          $("#inventoryButton").attr('class','open');
          document.getElementById("inventoryButton").innerHTML = 'Open Inventory';
        }
      });
     });

    $(function(){
      $('#textEditorTextArea').keyup(function(){
        var wordCount = 0;
        var paragraphCount = 0;
        var startsAndFinishes = $('#'+this.id).val().match(/\b/g);
        var newlinesWithText = $('#'+this.id).val().match(/(\n.)|(^.)/g);
        if (startsAndFinishes) {
          wordCount = startsAndFinishes.length / 2;
        }
        if (newlinesWithText) {
            paragraphCount = newlinesWithText.length;
          }
        $('#counts').html('Word Count: ' + wordCount + '<br />Paragraph Count: ' + paragraphCount);
      });
    });

    function changeSettings(form){
      console.log("Document Title: " + form.docName.value);
      console.log("Font Type: " + form.font.value);
      console.log("Font Color: " + form.color.value);
      console.log("Font Size: " + form.size.value);
      console.log("Paper Length Goal: " + form.lengthNum.value + " " + form.lengthType.value);

      if (form.docName.value != "")
      {
        document.getElementById("documentTitle").innerHTML = form.docName.value;
      }
      else
      {
        document.getElementById("documentTitle").innerHTML = "Untitled";
      }
      
      var textDoc = document.getElementById("textEditorTextArea");
      if (form.font.value != null)
      {
        $(textDoc).css("font-family", form.font.value);
      }

      if (form.color.value != null)
      {
        $(textDoc).css("color", form.color.value);
      }

      if (form.size.value!= null)
      {
        $(textDoc).css("font-size", form.size.value + "px");
      }

      
      if (!setup)
      {
        setup = true;
        docExists = true;
        var init = document.getElementById("initButton");
        $(init).attr("type", "hidden");
        var change = document.getElementById("changeButton");
        $(change).attr("type", "button");
      }

      if (docExists)
      {
        var cancel = document.getElementById("cancelButton");
        $(cancel).attr("type", "button");
      }

      redirect('#close');
      return false;
    }

    function cancel(){
      if (docExists)
      {
        redirect('#menuModal');
      }
      else if (!setup)
      {
        redirect('#startModal');
      }
    }

    function showAbout(){
      window.location = "#aboutModal";
      return false;
    }

    var setup = false;
    var docExists = false;

    function newDoc(){
      setup = false;
      redirect('#settingsModal');
    }

    $(document).ready(function(){
      redirect('#startModal');
      window.title = "Hat Scribe";
      var setup = false;
    });

    function gamble(){
      if(numStars == 0){
       alert('Not enough stars!');
      }
      else{
       numStars = numStars - 1;
       var tempArray = document.getElementsByName('numStars');
       for(var i = 0; i < tempArray.length;i++)
       {
         tempArray[i].innerHTML = numStars;
       }
       alert('You just gambled!');
      }
    }
      
    </script>

    <link rel ="stylesheet" type="text/css" href="css/stylesheet.css">
    <link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
    
  </head>
  <body>
    <div id="startModal" class="modalDialog">
      <div>
        <form name="setup" id="setup" align="center">
          <h1> Welcome to Hat Scribe </h1>
          <input type="button" value="Create New Document" onClick="redirect('#settingsModal')"></input>
          <br>
          <input type="button" value="Load Existing Document" onClick="redirect('#close')"></input>
          <br>
          <input type="button" value="About Hat Scribe" onClick="redirect('#aboutModal')"></input>
          <br>
        </form>
        <br>
      </div>
    </div>

    <div id="aboutModal" class="modalDialog">
      <div>
        <h2> About Hat Scribe </h2>
        <p> Hat Scribe is an interactive drafting tool intended to motivate users to write more by gamifying the writing process. This tool was designed by Team Mad Milliners for EECS 493, the User Interface class at the University of Michigan. <br><br>
          Our team consists of Vicki Li, Daniel Nees, and John Rabideau (with some initial help from Emily Stearns). All of us are computer science majors at the Engineering School here in Ann Arbor and qualified nerds/geeks.<br><br>
          If you have any questions, comments, or suggestions, we would love to hear them! Email your feedback to vickili@umich.edu, or let one of us know through any (preferably non-magical) methods otherwise.
        </p>
        <input type="button" value="Return" onClick="redirect('#startModal')"></input>
      </div>
    </div>

    <div id="menuModal" class="modalDialog">
      <div align="center">
          <h2> Menu </h2>
          <input type="button" id="createButton" value="Create New Document" onClick="newDoc()"></input><br>
          <input type="button" id="saveButton" value="Save Document" onClick=""></input><br>
          <input type="button" id="loadButton" value="Load Document" onClick=""></input><br>
          <input type="button" id="returnButton" value="Return" onClick="redirect('#close')"></input><br>
      </div>
    </div>

    <div id="settingsModal" class="modalDialog">
      <div>
        <form name="settings" id="settings">
          <h2> Document Settings </h2>
          Document Title: <input type="text" name="docName" placeholder="Untitled"><br><br>
          Font Type:
          <select name="font">
            <option value="Arial">Arial</option>
            <option value="Comic Sans">Comic Sans</option>
            <option value="Times New Roman">Times New Roman</option>
          </select><br><br>
          Font Color:
          <select name="color">
            <option value="Black">Black</option>
            <option value="Blue" style="color:blue">Blue</option>
            <option value="Green" style="color:green">Green</option>
            <option value="Red" style="color:red">Red</option>
          </select><br><br>
          Font Size:
          <select name="size">
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12" selected>12</option>
            <option value="13">13</option>
            <option value="14">14</option>
            <option value="15">15</option>
            <option value="16">16</option>
            <option value="17">17</option>
            <option value="18">18</option>
            <option value="19">19</option>
            <option value="20">20</option>            
          </select><br><br>
          Paper Length Goal: <input type="text" name="lengthNum" maxlength="5" size="5">
          <select name="lengthType">
            <option value="Words" selected>Words</option>
            <option value="Paragraphs">Paragraphs</option>
            <option value="Pages">Pages</option>
          </select><br><br>
          <input id="changeButton" type="hidden" value="Save Changes" onClick="changeSettings(this.form)"></input>
          <input id="cancelButton" type="hidden" value="Cancel" onClick="cancel()"></input>
          <input id="initButton" type="button" value="Create Document" onClick="changeSettings(this.form)"></input>
        </form>
        <br>
      </div>
    </div>

    <div id="breakModal" class="modalDialog">
      <div>
        Here's where the break stuff goes. NumStars: <span name="numStars">3</span>
        <br>
        <input id="gambleButton" type="button" value="Use a Star" onClick="gamble()"></input>
        <br>
        <input id="closeButton" type="button" value="Back to Work" onClick="redirect('#close')"></input>
      </div>
    </div>

    <div class="mainBody" id="mainBody">
      <div class="inventory" id="inventory">
        <p>Inventory thing</p>
        <button class="open" id="inventoryButton" type="button">Open Inventory</button>
        <div id="AvatarStats">Mark Stackerman<br/>
          Level 17<br/>
          342/500 XP<br>
        </div>
      </div>
      <div class="rightHalf" id="rightHalf">
        <div class="middleSection" id="middleSection">
          <div class="textEditor" id="textEditor">
            <input type="button" id="settingsOpen" value="Settings" onClick="redirect('#menuModal')"></input>
            <div class="hero-unit" id="documentTitle"></div>
            <textarea id="textEditorTextArea" placeholder="Start typing here!"></textarea>
          </div>
          <div class="break" id="break">
            <div id="counts">Word Count: <br />Paragraph Count: </div>
            <input id="breakButton" type="button" value="Take a Break!" onClick="redirect('#breakModal')"></input>
            <div id="stardiv" align="right">
              <img id="star" src="star.png">
              <span> x <span name="numStars">3</span> </span>
            </div>
          </div>
        </div>
        <div class="notifications" id="notifications">
        </div>
      </div>

    </div>

  </body>

</html>